<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>RH Biométrico | Dashboard</title>
  <link rel="stylesheet" href="styles.css">
  <!-- SheetJS for reading Excel files -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js" crossorigin="anonymous"></script>
  <!-- html2pdf.js for generating PDFs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" crossorigin="anonymous"></script>
  <!-- Fallback: Use unpkg CDN if primary CDN fails -->
  <script>
    window.addEventListener('load', function() {
      if (typeof XLSX === 'undefined') {
        console.warn('Primary SheetJS CDN failed, trying unpkg...');
        var script = document.createElement('script');
        script.src = 'https://unpkg.com/xlsx@0.20.1/dist/xlsx.full.min.js';
        document.head.appendChild(script);
      }
      if (typeof html2pdf === 'undefined') {
        console.warn('Primary html2pdf CDN failed, trying unpkg...');
        var script = document.createElement('script');
        script.src = 'https://unpkg.com/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js';
        document.head.appendChild(script);
      }
    });
  </script>
</head>
<body>

  <h2>RH Biométrico – Dashboard Histórico</h2>
  <p>Consultas por empleado, rango de fechas, analítica (asistencia, HE/TXT, beneficios) y exportación PDF.</p>

  <div class="filters">
    <label>Archivo Excel:
      <input type="file" id="fileUpload" accept=".xlsx, .xls" />
    </label>
  </div>

  <div class="filters">
    <label>Empleado:
      <select id="employee">
        <option value="TODOS">TODOS</option>
      </select>
    </label>

    <label>Desde:
      <input type="date" id="from">
    </label>

    <label>Hasta:
      <input type="date" id="to">
    </label>

    <button id="btnBuscar">Buscar</button>
    <button id="btnPDF">Exportar PDF</button>
  </div>

  <div id="status" class="status"></div>

  <div class="kpis" id="kpis">
    Eventos: 0 | Días: 0 | HE Calc: 00:00 | HE Pag: 00:00 | TXT: 00:00 | Beneficios Total: 0
  </div>

  <h3>Asistencia diaria</h3>
  <table class="results">
    <thead><tr id="headAsistencia"></tr></thead>
    <tbody id="bodyAsistencia"></tbody>
  </table>

  <h3>Horas Extra + TXT</h3>
  <table class="results">
    <thead><tr id="headHE"></tr></thead>
    <tbody id="bodyHE"></tbody>
  </table>

  <h3>Beneficios (Alimentación + Transporte)</h3>
  <table class="results">
    <thead><tr id="headBEN"></tr></thead>
    <tbody id="bodyBEN"></tbody>
  </table>

  <footer style="margin-top:14px;">
    RH Biométrico – Torre de Control CSS / DINALOG
  </footer>

  <script src="app.js"></script>
</body>
</html>
